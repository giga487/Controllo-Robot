function C = gen_dinamica_B(q,dq,parameter)

x1 = q(1);
x2 = q(2);
x3 = q(3);
x4 = q(4);
x5 = q(5);
dx1 = dq(1);
dx2 = dq(2);
dx3 = dq(3);
dx4 = dq(4);
dx5 = dq(5);
m_r = parameter(1);
m_c = parameter(2);
R_r = parameter(3);
L = parameter(4);
a = parameter(5);

C = [ dx3*((m_r*(8*R_r^2*cos(x2)^2*cos(x3)*sin(x3) + 2*a^2*cos(x2)^2*cos(x3)*sin(x3) + 4*L*a*cos(x2)*sin(x2)*sin(x3)))/8 - (m_r*(8*R_r^2*cos(x2)^2*cos(x3)*sin(x3) + 2*a^2*cos(x2)^2*cos(x3)*sin(x3) - 4*L*a*cos(x2)*cos(x3)*sin(x2)))/8 + (m_c*(6*a^2*cos(x2)^2*cos(x3)^2 - 6*a^2*cos(x2)^2*sin(x3)^2 + 12*L*a*cos(x2)*cos(x3)*sin(x2) + 12*L*a*cos(x2)*sin(x2)*sin(x3)))/24) - dx2*((m_c*(24*L^2*cos(x2)*sin(x2) - 6*a^2*cos(x2)*sin(x2) + 12*L*a*cos(x2)^2*cos(x3) - 12*L*a*cos(x3)*sin(x2)^2 - 12*L*a*cos(x2)^2*sin(x3) + 12*L*a*sin(x2)^2*sin(x3) + 12*a^2*cos(x2)*cos(x3)*sin(x2)*sin(x3)))/24 + (m_r*(8*L^2*cos(x2)*sin(x2) + 8*R_r^2*cos(x2)*sin(x2) - 8*R_r^2*cos(x2)*cos(x3)^2*sin(x2) - 2*a^2*cos(x2)*cos(x3)^2*sin(x2) + 4*L*a*cos(x2)^2*cos(x3) - 4*L*a*cos(x3)*sin(x2)^2))/8 + (m_r*(8*L^2*cos(x2)*sin(x2) - 2*a^2*cos(x2)*sin(x2) + 8*R_r^2*cos(x2)*cos(x3)^2*sin(x2) + 2*a^2*cos(x2)*cos(x3)^2*sin(x2) - 4*L*a*cos(x2)^2*sin(x3) + 4*L*a*sin(x2)^2*sin(x3)))/8), dx3*((a*((a*m_r*cos(x2))/2 - L*m_r*sin(x2)*sin(x3)))/4 + (a*m_c*(4*a*cos(x2) + 3*L*cos(x3)*sin(x2) - 3*L*sin(x2)*sin(x3)))/12 + (a*m_r*(a*cos(x2) + 2*L*cos(x3)*sin(x2)))/8 - (m_r*cos(x3)*(4*cos(x2)*cos(x3)*R_r^2 + cos(x2)*cos(x3)*a^2 + 2*L*sin(x2)*a))/8 + (m_r*cos(x3)*(4*cos(x2)*cos(x3)*R_r^2 + cos(x2)*cos(x3)*a^2))/8 - (m_r*sin(x3)*(4*cos(x2)*sin(x3)*R_r^2 + cos(x2)*sin(x3)*a^2 - 2*L*sin(x2)*a))/8 + (m_r*sin(x3)*(4*cos(x2)*sin(x3)*R_r^2 + cos(x2)*sin(x3)*a^2))/8 - (a*m_c*(cos(x3) - sin(x3))*(2*L*sin(x2) + a*cos(x2)*cos(x3) - a*cos(x2)*sin(x3)))/8 + (a*m_c*(cos(x3) + sin(x3))*(a*cos(x2)*cos(x3) + a*cos(x2)*sin(x3)))/8) - dx2*((m_r*cos(x3)*(4*sin(x2)*sin(x3)*R_r^2 + sin(x2)*sin(x3)*a^2 + 2*L*cos(x2)*a))/4 - (m_r*sin(x3)*(4*cos(x3)*sin(x2)*R_r^2 + cos(x3)*sin(x2)*a^2 - 2*L*cos(x2)*a))/4 + (a*m_c*(cos(x3) + sin(x3))*(2*L*cos(x2) - a*cos(x3)*sin(x2) + a*sin(x2)*sin(x3)))/4) - dx1*((m_c*(24*L^2*cos(x2)*sin(x2) - 6*a^2*cos(x2)*sin(x2) + 12*L*a*cos(x2)^2*cos(x3) - 12*L*a*cos(x3)*sin(x2)^2 - 12*L*a*cos(x2)^2*sin(x3) + 12*L*a*sin(x2)^2*sin(x3) + 12*a^2*cos(x2)*cos(x3)*sin(x2)*sin(x3)))/24 + (m_r*(8*L^2*cos(x2)*sin(x2) + 8*R_r^2*cos(x2)*sin(x2) - 8*R_r^2*cos(x2)*cos(x3)^2*sin(x2) - 2*a^2*cos(x2)*cos(x3)^2*sin(x2) + 4*L*a*cos(x2)^2*cos(x3) - 4*L*a*cos(x3)*sin(x2)^2))/8 + (m_r*(8*L^2*cos(x2)*sin(x2) - 2*a^2*cos(x2)*sin(x2) + 8*R_r^2*cos(x2)*cos(x3)^2*sin(x2) + 2*a^2*cos(x2)*cos(x3)^2*sin(x2) - 4*L*a*cos(x2)^2*sin(x3) + 4*L*a*sin(x2)^2*sin(x3)))/8) - (dx4*m_r*cos(x3)*sin(x2)*(4*L^2 + 4*R_r^2 + a^2))/8 + (dx5*m_r*sin(x2)*sin(x3)*(4*L^2 + 4*R_r^2 + a^2))/8, dx1*((m_r*(8*R_r^2*cos(x2)^2*cos(x3)*sin(x3) + 2*a^2*cos(x2)^2*cos(x3)*sin(x3) + 4*L*a*cos(x2)*sin(x2)*sin(x3)))/8 - (m_r*(8*R_r^2*cos(x2)^2*cos(x3)*sin(x3) + 2*a^2*cos(x2)^2*cos(x3)*sin(x3) - 4*L*a*cos(x2)*cos(x3)*sin(x2)))/8 + (m_c*(6*a^2*cos(x2)^2*cos(x3)^2 - 6*a^2*cos(x2)^2*sin(x3)^2 + 12*L*a*cos(x2)*cos(x3)*sin(x2) + 12*L*a*cos(x2)*sin(x2)*sin(x3)))/24) + dx2*((a*((a*m_r*cos(x2))/2 - L*m_r*sin(x2)*sin(x3)))/4 + (a*m_c*(4*a*cos(x2) + 3*L*cos(x3)*sin(x2) - 3*L*sin(x2)*sin(x3)))/12 + (a*m_r*(a*cos(x2) + 2*L*cos(x3)*sin(x2)))/8 - (m_r*cos(x3)*(4*cos(x2)*cos(x3)*R_r^2 + cos(x2)*cos(x3)*a^2 + 2*L*sin(x2)*a))/8 + (m_r*cos(x3)*(4*cos(x2)*cos(x3)*R_r^2 + cos(x2)*cos(x3)*a^2))/8 - (m_r*sin(x3)*(4*cos(x2)*sin(x3)*R_r^2 + cos(x2)*sin(x3)*a^2 - 2*L*sin(x2)*a))/8 + (m_r*sin(x3)*(4*cos(x2)*sin(x3)*R_r^2 + cos(x2)*sin(x3)*a^2))/8 - (a*m_c*(cos(x3) - sin(x3))*(2*L*sin(x2) + a*cos(x2)*cos(x3) - a*cos(x2)*sin(x3)))/8 + (a*m_c*(cos(x3) + sin(x3))*(a*cos(x2)*cos(x3) + a*cos(x2)*sin(x3)))/8) + dx3*((a*m_c*(3*L*cos(x2)*cos(x3) + 3*L*cos(x2)*sin(x3)))/6 + (L*a*m_r*cos(x2)*cos(x3))/2 + (L*a*m_r*cos(x2)*sin(x3))/2) - (dx5*m_r*cos(x2)*cos(x3)*(4*L^2 + 4*R_r^2 + a^2))/8 - (dx4*m_r*cos(x2)*sin(x3)*(4*L^2 + 4*R_r^2 + a^2))/8, - (dx2*m_r*cos(x3)*sin(x2)*(4*L^2 + 4*R_r^2 + a^2))/8 - (dx3*m_r*cos(x2)*sin(x3)*(4*L^2 + 4*R_r^2 + a^2))/8, (dx2*m_r*sin(x2)*sin(x3)*(4*L^2 + 4*R_r^2 + a^2))/8 - (dx3*m_r*cos(x2)*cos(x3)*(4*L^2 + 4*R_r^2 + a^2))/8;
 dx1*((m_c*(24*L^2*cos(x2)*sin(x2) - 6*a^2*cos(x2)*sin(x2) + 12*L*a*cos(x2)^2*cos(x3) - 12*L*a*cos(x3)*sin(x2)^2 - 12*L*a*cos(x2)^2*sin(x3) + 12*L*a*sin(x2)^2*sin(x3) + 12*a^2*cos(x2)*cos(x3)*sin(x2)*sin(x3)))/24 + (m_r*(8*L^2*cos(x2)*sin(x2) + 8*R_r^2*cos(x2)*sin(x2) - 8*R_r^2*cos(x2)*cos(x3)^2*sin(x2) - 2*a^2*cos(x2)*cos(x3)^2*sin(x2) + 4*L*a*cos(x2)^2*cos(x3) - 4*L*a*cos(x3)*sin(x2)^2))/8 + (m_r*(8*L^2*cos(x2)*sin(x2) - 2*a^2*cos(x2)*sin(x2) + 8*R_r^2*cos(x2)*cos(x3)^2*sin(x2) + 2*a^2*cos(x2)*cos(x3)^2*sin(x2) - 4*L*a*cos(x2)^2*sin(x3) + 4*L*a*sin(x2)^2*sin(x3)))/8) - dx3*((a*((a*m_r*cos(x2))/2 - L*m_r*sin(x2)*sin(x3)))/4 + (a*m_c*(4*a*cos(x2) + 3*L*cos(x3)*sin(x2) - 3*L*sin(x2)*sin(x3)))/12 + (a*m_r*(a*cos(x2) + 2*L*cos(x3)*sin(x2)))/8 + (m_r*cos(x3)*(4*cos(x2)*cos(x3)*R_r^2 + cos(x2)*cos(x3)*a^2 + 2*L*sin(x2)*a))/8 - (m_r*cos(x3)*(4*cos(x2)*cos(x3)*R_r^2 + cos(x2)*cos(x3)*a^2))/8 + (m_r*sin(x3)*(4*cos(x2)*sin(x3)*R_r^2 + cos(x2)*sin(x3)*a^2 - 2*L*sin(x2)*a))/8 - (m_r*sin(x3)*(4*cos(x2)*sin(x3)*R_r^2 + cos(x2)*sin(x3)*a^2))/8 + (a*m_c*(cos(x3) - sin(x3))*(2*L*sin(x2) + a*cos(x2)*cos(x3) - a*cos(x2)*sin(x3)))/8 - (a*m_c*(cos(x3) + sin(x3))*(a*cos(x2)*cos(x3) + a*cos(x2)*sin(x3)))/8) + (dx4*m_r*cos(x3)*sin(x2)*(4*L^2 + 4*R_r^2 + a^2))/8 - (dx5*m_r*sin(x2)*sin(x3)*(4*L^2 + 4*R_r^2 + a^2))/8,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      -(a^2*dx3*m_c*cos(2*x3))/4,                                                                                                                                                                                                                                                                                                                                                                                                         (dx4*m_r*cos(x3)*(4*L^2 + 4*R_r^2 + a^2))/8 - dx1*((a*m_c*(4*a*cos(x2) + 3*L*cos(x3)*sin(x2) - 3*L*sin(x2)*sin(x3)))/12 + (a*m_r*(a*cos(x2) + 2*L*cos(x3)*sin(x2)))/8 + (m_r*cos(x3)*(4*cos(x2)*cos(x3)*R_r^2 + cos(x2)*cos(x3)*a^2 + 2*L*sin(x2)*a))/8 - (m_r*cos(x3)*(4*cos(x2)*cos(x3)*R_r^2 + cos(x2)*cos(x3)*a^2))/8 + (a*m_r*(a*cos(x2) - 2*L*sin(x2)*sin(x3)))/8 + (m_r*sin(x3)*(4*cos(x2)*sin(x3)*R_r^2 + cos(x2)*sin(x3)*a^2 - 2*L*sin(x2)*a))/8 - (m_r*sin(x3)*(4*cos(x2)*sin(x3)*R_r^2 + cos(x2)*sin(x3)*a^2))/8 + (a*m_c*(cos(x3) - sin(x3))*(2*L*sin(x2) + a*cos(x2)*cos(x3) - a*cos(x2)*sin(x3)))/8 - (a*m_c*(cos(x3) + sin(x3))*(a*cos(x2)*cos(x3) + a*cos(x2)*sin(x3)))/8) - (a^2*dx2*m_c*cos(2*x3))/4 - dx3*((L*a*m_r*cos(x3))/2 - (L*a*m_r*sin(x3))/2 + (2^(1/2)*L*a*m_c*cos(x3 + pi/4))/2) - (dx5*m_r*sin(x3)*(4*L^2 + 4*R_r^2 + a^2))/8,           (dx3*m_r*cos(x3)*(4*L^2 + 4*R_r^2 + a^2))/8 + (dx1*m_r*cos(x3)*sin(x2)*(4*L^2 + 4*R_r^2 + a^2))/8,       - (dx3*m_r*sin(x3)*(4*L^2 + 4*R_r^2 + a^2))/8 - (dx1*m_r*sin(x2)*sin(x3)*(4*L^2 + 4*R_r^2 + a^2))/8;
                                                                                                                                                                                                                             dx2*((a*m_c*(4*a*cos(x2) + 3*L*cos(x3)*sin(x2) - 3*L*sin(x2)*sin(x3)))/12 + (a*m_r*(a*cos(x2) + 2*L*cos(x3)*sin(x2)))/8 + (m_r*cos(x3)*(4*cos(x2)*cos(x3)*R_r^2 + cos(x2)*cos(x3)*a^2 + 2*L*sin(x2)*a))/8 - (m_r*cos(x3)*(4*cos(x2)*cos(x3)*R_r^2 + cos(x2)*cos(x3)*a^2))/8 + (a*m_r*(a*cos(x2) - 2*L*sin(x2)*sin(x3)))/8 + (m_r*sin(x3)*(4*cos(x2)*sin(x3)*R_r^2 + cos(x2)*sin(x3)*a^2 - 2*L*sin(x2)*a))/8 - (m_r*sin(x3)*(4*cos(x2)*sin(x3)*R_r^2 + cos(x2)*sin(x3)*a^2))/8 + (a*m_c*(cos(x3) - sin(x3))*(2*L*sin(x2) + a*cos(x2)*cos(x3) - a*cos(x2)*sin(x3)))/8 - (a*m_c*(cos(x3) + sin(x3))*(a*cos(x2)*cos(x3) + a*cos(x2)*sin(x3)))/8) - dx1*((m_r*(8*R_r^2*cos(x2)^2*cos(x3)*sin(x3) + 2*a^2*cos(x2)^2*cos(x3)*sin(x3) + 4*L*a*cos(x2)*sin(x2)*sin(x3)))/8 - (m_r*(8*R_r^2*cos(x2)^2*cos(x3)*sin(x3) + 2*a^2*cos(x2)^2*cos(x3)*sin(x3) - 4*L*a*cos(x2)*cos(x3)*sin(x2)))/8 + (m_c*(6*a^2*cos(x2)^2*cos(x3)^2 - 6*a^2*cos(x2)^2*sin(x3)^2 + 12*L*a*cos(x2)*cos(x3)*sin(x2) + 12*L*a*cos(x2)*sin(x2)*sin(x3)))/24) + (dx5*m_r*cos(x2)*cos(x3)*(4*L^2 + 4*R_r^2 + a^2))/8 + (dx4*m_r*cos(x2)*sin(x3)*(4*L^2 + 4*R_r^2 + a^2))/8,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            dx1*((a*m_c*(4*a*cos(x2) + 3*L*cos(x3)*sin(x2) - 3*L*sin(x2)*sin(x3)))/12 + (a*m_r*(a*cos(x2) + 2*L*cos(x3)*sin(x2)))/8 + (m_r*cos(x3)*(4*cos(x2)*cos(x3)*R_r^2 + cos(x2)*cos(x3)*a^2 + 2*L*sin(x2)*a))/8 - (m_r*cos(x3)*(4*cos(x2)*cos(x3)*R_r^2 + cos(x2)*cos(x3)*a^2))/8 + (a*m_r*(a*cos(x2) - 2*L*sin(x2)*sin(x3)))/8 + (m_r*sin(x3)*(4*cos(x2)*sin(x3)*R_r^2 + cos(x2)*sin(x3)*a^2 - 2*L*sin(x2)*a))/8 - (m_r*sin(x3)*(4*cos(x2)*sin(x3)*R_r^2 + cos(x2)*sin(x3)*a^2))/8 + (a*m_c*(cos(x3) - sin(x3))*(2*L*sin(x2) + a*cos(x2)*cos(x3) - a*cos(x2)*sin(x3)))/8 - (a*m_c*(cos(x3) + sin(x3))*(a*cos(x2)*cos(x3) + a*cos(x2)*sin(x3)))/8) + (a^2*dx2*m_c*cos(2*x3))/4 - (dx4*m_r*cos(x3)*(4*L^2 + 4*R_r^2 + a^2))/8 + (dx5*m_r*sin(x3)*(4*L^2 + 4*R_r^2 + a^2))/8,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   0,           (dx1*m_r*cos(x2)*sin(x3)*(4*L^2 + 4*R_r^2 + a^2))/8 - (dx2*m_r*cos(x3)*(4*L^2 + 4*R_r^2 + a^2))/8,         (dx2*m_r*sin(x3)*(4*L^2 + 4*R_r^2 + a^2))/8 + (dx1*m_r*cos(x2)*cos(x3)*(4*L^2 + 4*R_r^2 + a^2))/8;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     - (dx2*m_r*cos(x3)*sin(x2)*(4*L^2 + 4*R_r^2 + a^2))/8 - (dx3*m_r*cos(x2)*sin(x3)*(4*L^2 + 4*R_r^2 + a^2))/8,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (dx3*m_r*cos(x3)*(4*L^2 + 4*R_r^2 + a^2))/8 - (dx1*m_r*cos(x3)*sin(x2)*(4*L^2 + 4*R_r^2 + a^2))/8,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (dx2*m_r*cos(x3)*(4*L^2 + 4*R_r^2 + a^2))/8 - (dx1*m_r*cos(x2)*sin(x3)*(4*L^2 + 4*R_r^2 + a^2))/8,                                                                                                           0,                                                                                                         0;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (dx2*m_r*sin(x2)*sin(x3)*(4*L^2 + 4*R_r^2 + a^2))/8 - (dx3*m_r*cos(x2)*cos(x3)*(4*L^2 + 4*R_r^2 + a^2))/8,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               (dx1*m_r*sin(x2)*sin(x3)*(4*L^2 + 4*R_r^2 + a^2))/8 - (dx3*m_r*sin(x3)*(4*L^2 + 4*R_r^2 + a^2))/8,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 - (dx2*m_r*sin(x3)*(4*L^2 + 4*R_r^2 + a^2))/8 - (dx1*m_r*cos(x2)*cos(x3)*(4*L^2 + 4*R_r^2 + a^2))/8,                                                                                                           0,                                                                                                         0];
 
end